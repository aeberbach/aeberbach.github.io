<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Gray Unicorn"/><link rel="canonical" href="https://grayunicorn.com/posts/2019-04-01-a1200-kbd-3"/><meta name="twitter:url" content="https://grayunicorn.com/posts/2019-04-01-a1200-kbd-3"/><meta name="og:url" content="https://grayunicorn.com/posts/2019-04-01-a1200-kbd-3"/><title>Amiga 1200 Keyboard, part 3 | Gray Unicorn</title><meta name="twitter:title" content="Amiga 1200 Keyboard, part 3 | Gray Unicorn"/><meta name="og:title" content="Amiga 1200 Keyboard, part 3 | Gray Unicorn"/><meta name="description" content="Schematic design"/><meta name="twitter:description" content="Schematic design"/><meta name="og:description" content="Schematic design"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Gray Unicorn"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">Gray Unicorn</a><nav><ul><li><a href="/pages">Pages</a></li><li><a class="selected" href="/posts">Posts</a></li></ul></nav></div></header><div class="wrapper"><article><div class="content"><h1>Amiga 1200 Keyboard, part 3</h1><h2>Drawing the schematic.</h2><p>In the last part the circuit was derived by tracing the membrane in the original A1200 keyboard. This time that circuit is going to be turned into a schematic drawing, with the output being a netlist - simply, a list of pins connected to parts (keyswitches, LED, connector) that are connected together.</p><p>Because it makes for nice organisation they keys in the schematic go in roughly the same place they would be on a real keyboard. Compared to making a PCB schematic is not hard at all - wires can cross and go pretty much anywhere as long as you can keep track of them. Unless you see a big green dot you don't have a connection. Obviously you don't want to make something you can't read so keeping it neat is a good idea.</p><p><a href="/images/2019-04-01-a1200-kbd-3/schematic.jpg"><img src="/images/2019-04-01-a1200-kbd-3/thumb-schematic.jpg" alt="Part of schematic drawing"/></a></p><p>Looking at the circuit you can see that it is a matrix. The keys, with two terminals each, could be directly connected to the controller, for around 200 connections from keyboard to controller. Or like a joystick they could all use one common connection and then there would only be 100 wires or so, one from each switch plus one common. But better still is to use a matrix where a key is defined by two connections, and when those connections are bridged the controller derives a unique key. The minimum you would need is rows + columns connections - so in a really simple keyboard like this standalone numpad:</p><img src="/images/2019-04-01-a1200-kbd-3/numpad.jpg" alt="GoldTouch numpad"/><p>The minimum would be only 10 connections from matrix to controller because there are 4 column and 6 rows. All this minimisation is good because connections cost time and money. The Amiga however has a special set of keys with their own connections not shared with the regular matrix. These are keys like CTRL, L-AMIGA etc - the ones that can't be blocked by another key. Ignoring the connections to the LED that lights when CAPSLOCK is pressed it uses 29 connections to the controller chip, via the ribbon cable that emerges from the top of the membrane.</p><p>I could write a whole article about the keyboard matrix and try to make it good, but it's been done really well already - please take a look at <a href="http://blog.komar.be/how-to-make-a-keyboard-the-matrix/">komar's tech blog</a>.</p><p>Because I just want to make a replacement keyboard I am not using diodes or changing the layout in any way from the original. The circuit is exactly the same right down to the flipped row/column connections on some of the keys like F6. I do not think that making all this completely regular could have had an effect, as these are just passive switches, but I'm not changing it. The keyboard should be better with mechanical switches, but it should not be electrically different - bugs and all.</p><p>When the schematic is done the output is a netlist. This is just a text file that defines what's in the circuit and how the things are connected. The first part describes the components. Here are two entries (and part of a third) describing the switches:</p><pre><code>  (components
    (comp (ref K2)
      (value F1)
      (footprint MX_Alps_Hybrid:MXOnly-1.25U-NoLED)
      (libsource (lib MX_Alps_Hybrids) (part MX-1.25U) (description ""))
      (sheetpath (names /) (tstamps /))
      (tstamp 5C7001B7))
    (comp (ref K3)
      (value F2)
      (footprint MX_Alps_Hybrid:MXOnly-1.25U-NoLED)
      (libsource (lib MX_Alps_Hybrids) (part MX-1.25U) (description ""))
      (sheetpath (names /) (tstamps /))
      (tstamp 5C70020E))
    (comp (ref K4)
      (value F3)
      (footprint MX_Alps_Hybrid:MXOnly-1.25U-NoLED)
      (libsource (lib MX_Alps_Hybrids) (part MX-1.25U) (description ""))
</code></pre><p>I'm using the excellent library by github user <a href="https://github.com/ai03-2725/MX_Alps_Hybrid.pretty">ai03-2725</a> - highly recommended. I don't love the schematic symbols, because all of the keys have a diode which when unconnected causes KiCAD to complain when transferring to PC. But the PCB footprints are excellent!</p><p>Late in the netlist comes the description of the nets themselves - here's one of them:</p><pre><code>    (net (code 198) (name /18)
      (node (ref K36) (pin 1))
      (node (ref K55) (pin 1))
      (node (ref K3) (pin 1))
      (node (ref J1) (pin 18))
      (node (ref K74) (pin 1))
      (node (ref K15) (pin 1))
      (node (ref K68) (pin 1)))
</code></pre><p>This means that there is a net named "18", joining the pins of the components listed. I named is "18" because it matches pin 18 of the connector. And it's as simple as that. If you look at the netlist file you can manually check that all of the nets are connected the way you wanted them. This is a good idea because though it is not an exciting job it's a lot better than soldering bits of wire on your new PCB correcting in hardware the errors you should have fixed on paper.</p><p>Next time - making the PCB.</p></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/computers">computers</a></li><li><a href="/tags/development">development</a></li><li><a href="/tags/retrocomputing">retrocomputing</a></li><li><a href="/tags/making">making</a></li></ul></article></div><footer><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>